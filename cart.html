<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cart - Shopora</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Jockey+One&display=swap" rel="stylesheet" />
</head>
<body>
  <div class="flex-container">
    <div class="logo">
      <img src="images/logo.png" alt="Shopora Logo" />
      <span class="logo-text">Shopora</span>
    </div>
    <div class="navlinks">
      <a href="index.html">Home</a>
      <a href="cart.html" class="active">Cart</a>
      <a href="wishlist.html">Wishlist</a>
      <a href="about.html">About</a>
      <a href="contact.html">Contact Us</a>
      <a href="orders.html">Orders</a>
      <a href="login.html">Login</a>
      <a href="register.html">Register</a>
    </div>
  </div>

  <main class="cart-container">
    <h2 class="section-heading">Your Shopping Cart</h2>
    <div class="section-divider"></div>

    <div id="cart-items-display">
      <p id="empty-cart-message">Your cart is empty. Start shopping!</p>
    </div>

    <div class="cart-summary" style="margin-top: 20px; text-align: right;">
      <p style="font-size: 1.2rem;">Subtotal: ₹<span id="cart-subtotal">0.00</span></p>
      <button id="checkout-button" class="register-button" style="margin-top: 10px;">Place Order</button>
    </div>
  </main>

  <script>
    document.getElementById('checkout-button').addEventListener('click', () => {
      window.location.href = 'checkout.html';
    });

    function loadCartItems() {
      const display = document.getElementById('cart-items-display');
      const ids = JSON.parse(localStorage.getItem('cart')) || [];
      display.innerHTML = '';

      if (ids.length === 0) {
        display.innerHTML = '<p id="empty-cart-message">Your cart is empty. Start shopping!</p>';
        document.getElementById('cart-subtotal').textContent = '0.00';
        return;
      }

      fetch('products.json')
        .then(response => response.json())
        .then(products => {
          let total = 0;

          ids.forEach(id => {
            const product = products.find(p => p.id === id);
            if (product) {
              total += product.price;

              const div = document.createElement('div');
              div.className = 'cart-item';
              div.innerHTML = `
                <img src="${product.image}" alt="${product.name}" width="100" height="100">
                <div class="cart-item-details">
                  <h3>${product.name}</h3>
                  <p>${product.description}</p>
                  <p><strong>₹${product.price.toFixed(2)}</strong></p>
                </div>
                <button class="remove-from-cart" data-id="${product.id}">Remove</button>
              `;

              display.appendChild(div);
            }
          });

          document.getElementById('cart-subtotal').textContent = total.toFixed(2);
        })
        .catch(err => {
          console.error("Failed to load cart items:", err);
          display.innerHTML = '<p>Something went wrong loading your cart.</p>';
        });
    }

    function removeFromCart(id) {
      let items = JSON.parse(localStorage.getItem('cart')) || [];
      items = items.filter(itemId => itemId !== id);
      localStorage.setItem('cart', JSON.stringify(items));
      loadCartItems();
    }

    document.addEventListener('click', e => {
      if (e.target.classList.contains('remove-from-cart')) {
        const id = parseInt(e.target.dataset.id);
        removeFromCart(id);
      }
    });

    document.addEventListener('DOMContentLoaded', () => {
      loadCartItems();
    });
  </script>
</body>
</html>
